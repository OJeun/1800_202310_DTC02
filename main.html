<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="./src/css/hydration.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,500;1,400&display=swap" rel="stylesheet">
  <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
    integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous"> -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="src/hydration.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://code.jquery.com/ui/1.13.0/jquery-ui.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/ui/4.8.1/firebase-ui-auth.js"></script>
  <script src="./src/firebaseAPI_TEAM02.js"></script>
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.0/themes/smoothness/jquery-ui.css">
  <link rel="stylesheet" href="src/css/main.css">
  <style>
    #homepage{color: #009578;}
  </style>
 
  <script>
    window.onload = async function () {
      console.log("window on load successful");
      await firebase.auth().onAuthStateChanged(function (user) {
        if (user) {
          var dogsCollection = db.collection("users").doc(user.uid).collection("dogs");
          dogsCollection.get().then((querySnapshot) => {
            querySnapshot.forEach((doc) => {
              // Access the fields in the document using the data() method
              const dogData = doc.data();
              const dogId = doc.id;
              dogsArray.push({
                id: dogId,
                name: dogData.name,
                age: dogData.age,
                breed: dogData.breed,
                profilePic: dogData.profilePic
              });

            });
            const listOfDogs = document.getElementById("dogsList");
            dogsArray.forEach(dog => {
            if (dog.profilePic == null) {
              dog.profilePic = "https://easydrawingguides.com/wp-content/uploads/2018/09/Snoopy-10.png"
            }  
              listOfDogs.innerHTML += ` 
                                     <div class="card">
                                      <img id="mypic-goes-here" src="${dog.profilePic}" alt="./images/blah.jpeg" width=50 height=50 />
      <div class="card-body">
        <h5 class="card-title">${dog.name}</h5>
        <a href="#" class="btn btn-primary" data-dog-id="${dog.id}" data-dog-name ="${dog.name}" onclick = "switchDog()">Select this Dog</a>
      </div>
    </div>`;
            });
          }).catch(error => {
            console.log("Error getting dogs collection:", error);
          });
          console.log(dogsArray);
        }


        if (localStorage.getItem("currentDogName") !== null) {
          console.log("you have a dog selected")
          document.getElementById("currentDogSelected").innerHTML = "You are currently viewing dog: " + localStorage.getItem("currentDogName");
        } else {
          console.log("current dog is null")
        }

        var dogsCollection = db.collection("users").doc(user.uid).collection("dogs");
        var noDogs;
        dogsCollection.get().then(querySnapshot => {
          if (querySnapshot.empty) {
            console.log("You have dogs");
            document.getElementById("currentDogSelected").innerHTML = "Get Started by adding a dog";
          }
        }).catch(error => {
          console.log("Error getting document:", error);
        });




      });




    };

  </script>

</head>

<body>
  <nav id="navbarPlaceholder"></nav>

  <main>
    <div class="container-fluid text-dark p-5 main-container-card">
      <div class="container p-5 secondary-container-card">
        <h1 class="display-4">
          Good morning, <span id="name-goes-here"></span> 
          <br><br> 
          <span id="currentDogSelected">Please Select a
            dog</span>
        </h1>
      </div>
    </div>
    
    <div id="dogsList">
      
    </div>
    <div class="addDogButton"><button><a href="addDog.html">+Add your dog</a></button></div>
    

  </main>







  <nav id="footerPlaceholder"></nav>

  <script src="./src/skeleton.js"></script>
  <script src="./src/main.js"></script>
  <script src="./src/switchDog.js"></script>
  <script src="./src/dogProfile.js"></script>


</body>

</html>